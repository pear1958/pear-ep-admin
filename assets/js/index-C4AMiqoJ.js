import{c0 as p}from"./index-iSRBwhZQ.js";function d(t,n){return new Promise((e,o)=>{let i=document.createElement("CANVAS");const s=i.getContext("2d"),a=new Image;a.crossOrigin="",a.onload=function(){if(!i||!s)return o();i.height=a.height,i.width=a.width,s.drawImage(a,0,0);const r=i.toDataURL("image/png");i=null,e(r)},a.src=t})}function g(t){const n=t.split(","),o=n[0].match(/:(.*?);/)[1],i=window.atob(n[1]);let s=i.length;const a=new Uint8Array(s);for(;s--;)a[s]=i.charCodeAt(s);return new Blob([a],{type:o})}const c=t=>{const n=t.split("/").pop(),e=Math.random().toString(16).slice(2)+".png";return n.includes(".")&&/\.(bmp|jpg|png|tif|gif|pcx|tga|exif|fpx|svg|psd|cdr|pcd|dxf|ufo|eps|ai|raw|wmf|jpeg)$/.test(n.toLowerCase())?n:e},l=(t,n)=>{const e=window.URL.createObjectURL(t),o=document.createElement("a");o.style.display="none",o.href=e,n&&o.setAttribute("download",n),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e)};function w(t,n,e){const o=new Blob([t],{type:e||"application/octet-stream"});l(o,n)}function m(t,n,e){const o=g(t);w(o,n,e)}async function b(t,n,e){n||(n=c(t));const o=await d(t);m(o,n,e)}function y(t,n,e="_self"){const o=window.navigator.userAgent.toLowerCase().indexOf("chrome")>-1,i=window.navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(/(iP)/g.test(window.navigator.userAgent))return console.error("您的浏览器不支持下载!"),!1;if(o||i){const s=document.createElement("a");if(s.href=t,s.target=e,s.download!==void 0&&(s.download=n||c(t)),document.createEvent){const a=document.createEvent("MouseEvents");return a.initEvent("click",!0,!0),s.dispatchEvent(a),!0}}t.indexOf("?")===-1&&(t+="?download"),window.open(t,e)}function h(t,n){const e=new window.XMLHttpRequest;e.open("GET",t,!0),e.responseType="blob",e.onload=()=>{e.status===200&&l(e.response,n)},e.send()}const x=async(t,n="图片附件")=>{try{const e=new p,o=e.folder(n);(await Promise.all(t.map(a=>d(a)))).forEach((a,r)=>{const f=c(t[r]);o.file(f,a.substring(22),{base64:!0})});const s=await e.generateAsync({type:"blob"});w(s,`${n}.zip`)}catch(e){console.log("err",e),alert("下载失败")}};export{m as a,y as b,h as c,b as d,x as e,w as f};
