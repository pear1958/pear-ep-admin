import{aV as k,bt as we,aG as ke,aA as He,aL as We,aE as Xe,d as U,x as I,aP as G,cD as q,aB as Ge,bE as ie,o as P,b as L,aZ as $,az as xe,b$ as ye,c3 as Ze,aj as H,bl as Qe,bL as ce,bB as Ae,cE as ae,bg as Te,a_ as A,a as w,L as Ee,bJ as p,A as R,bc as W,F as X,aY as ee,av as j,u as l,cF as D,b0 as fe,O as y,cG as Ye,z as V,cH as ze,N as B,cI as de,cJ as Je,cK as qe,bR as Ne,aT as Be,bh as ea,cL as aa,cM as _e,ay as ta,a8 as na,ar as ra,cN as la,a$ as sa,cO as Ie,cP as oa,cQ as ua,cR as ia,cS as Pe,bU as pe,cT as ca,cU as da,cV as pa,cW as fa,cX as ma,cY as ga,cZ as ha}from"./index-iSRBwhZQ.js";import{S as va}from"./sortable.esm-Cw1ESr5Y.js";import{columns as ba}from"./columns-Z5Y1JHCx.js";import{E as ya}from"./index-BcCNBKaj.js";const Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAzCAMAAAA3r39rAAABEVBMVEUAAADb29va2trY2Njj4+PX19fZ2dng4ODf39/X19fj4+Py8vLk5OTt7e3V1dX09PT29vbZ2dn39/fY2Nj29vbb29v29vb29vb19fX29vbV1dX39/f29vb29vb19fXc3NzZ2dnd3d3e3t7h4eH19fX19fXZ2dn19fX39/fb29vb29vW1tb19fXT09P29vbf39/29vb19fXU1NTn5+fc3NzR0dH29vb19fX19fX29vbT09P39/f19fX39/ff39/39/fX19f19fXr6+vo6OjZ2dnn5+fb29vj4+Pd3d319fXm5ubm5ubj4+PY2Nja2tr39/fk5OT6+vr09PTm5ub39/f8/Pzx8fHi4uLp6enr6+vt7e37h5dsAAAAUXRSTlMAQpJ0ChanzshV+g7jBMAS47ONcNMd++jew4heMx7LwJ5HI/j387y3rKx3XFNPSeSabWswKyjt2b2ikYWBc108mZZsaT339evZsKycgX5QGL+U+rOeAAAC3UlEQVRYw+WV13qiQBiGiaIbJaAgFgTsvZds7DG9l3UEBnP/F7IIDyYmgDB7uO8R4Mc7/8z8I5gdhabfgfMC5pHfvnrOZ0uu7vvt0TfN9vNHtuSvqLQnYzxNneNOAfy8ko679xEv2QHpHCGvqRfCrQ8fZF/xg6FGZYC79DUpN9MJvFJNd8a3is9VUxR8lZCb3BGdc7mBhRydP5waBulTzCWn9frw4KhB+ghzzQ0dLBxowAs6hHngjc7FERraHtK5IyKx7BWBeYK4zjYitg14TW9/9Gj001e4XfkVXwDzTGBKN0nL+kIU5W+3Qyb5uMNa53exdjtGUSHcaqSLu+7xr0+Og7Zdmw/uBbt3FwErYbD4AZQdQIH1U7t+hspXPopBa2EYyKsdsqx0G9bCxokif02CsLPQzEnw2Vr4vNYD7oUm8Im07IYndbWHa6FasVzEYXYjowmV7rR9c/SNm/a0CxAqNIzFh+MfPBSVFYLQVP5EKw9ZaDaH81NnIQK2wlwRrNCExZyVkEjfowrv04SFEI+doApPYriNUP7PhAN04cBKGPGjCy2+bYTQz4ZRdzn8py8Qe7bOrMaNbteowvXtiKvNOqZT5BmuDCSwRheq2utljuHF7V4se1Gg8Q9CRRdqRHtLHGtx2pUhhIqMJoSa0JBwLWycMHQS+EAUyhuo6AKNxBjT52s4obqSNfSUcfU5gH4jf8N4Iq0hkCRgEMUuk6ZQ2kBVAZ5RVLjRfEaNyUtsyET1SW9vVQjXnoFwY7oTUWaonRC+miztRvMuVLcLuKWUrPL6icHFDsMm9EkDFCT9vQTLdETzSJPikp/X2JKESImtzfmlSO7/NwitBTOpZlJl4IFyKlOdMIuWEMGsIN+FVn/Wq1W5DJuKJs/KpcRnU5kkSuWzZDTFZrhqrTfrt4R3EnOAxAkiIgodfjFnepPHcSbDjlJb+VaSGrFsZvw4uWTmC74jiBGCwL/b/gIpvWL/TS00iAAAAABJRU5ErkJggg==",_a=()=>{const i=k("xl"),u=k(-1),t=we().default();ke(()=>{o({target:{innerWidth:window.innerWidth}}),window.addEventListener("resize",o)}),He(()=>{o({target:{innerWidth:window.innerWidth}}),window.addEventListener("resize",o)});const o=d=>{const r=d.target.innerWidth;switch(!!r){case r<768:i.value="xs";break;case(r>=768&&r<992):i.value="sm";break;case(r>=992&&r<1200):i.value="md";break;case(r>=1200&&r<1920):i.value="lg";break;case r>=1920:i.value="xl";break}},g=(d,r)=>{var s,c,h,_;const a=[];let n=null;t.forEach(m=>{var C;typeof m.type=="object"&&m.type.name==="GridItem"&&((C=m.props)==null?void 0:C.suffix)!==void 0&&(n=m),typeof m.type=="symbol"&&Array.isArray(m.children)&&a.push(...m.children)});let e=0;n&&(e=(((s=n.props[i.value])==null?void 0:s.span)??((c=n.props)==null?void 0:c.span)??1)+(((h=n.props[i.value])==null?void 0:h.offset)??((_=n.props)==null?void 0:_.offset)??0));try{let m=!1;a.reduce((C=0,T,N)=>{var E,x,M,O;if(C+=(((E=T.props[i.value])==null?void 0:E.span)??((x=T.props)==null?void 0:x.span)??1)+(((M=T.props[i.value])==null?void 0:M.offset)??((O=T.props)==null?void 0:O.offset)??0),Number(C)>d.collapsedRows*r.value-e)throw u.value=N,m=!0,"find it";return C},0),m||(u.value=-1)}catch{}};return We(()=>{window.removeEventListener("resize",o)}),Xe(()=>{window.removeEventListener("resize",o)}),{breakPoint:i,hiddenIndex:u,findIndex:g}},Pa=U({name:"Grid",__name:"index",props:{gap:{default:0},cols:{default:()=>({xs:1,sm:2,md:2,lg:3,xl:4})},collapsed:{type:Boolean,default:!1},collapsedRows:{default:1}},setup(i,{expose:u}){const t=i,{breakPoint:o,hiddenIndex:g,findIndex:d}=_a(),r=I(()=>{const{gap:e}=t;return ye(e)?`${e}px`:q(e)?`${e[0]}px ${e[1]}px`:"unset"}),a=I(()=>{const{cols:e}=t;return ye(e)?e:Ze(e)?e[o.value]:4}),n=I(()=>({display:"grid",gridGap:r.value,gridTemplateColumns:`repeat(${a.value}, minmax(0, 1fr))`}));return G("breakPoint",o),G("hiddenIndex",g),G("gap",q(t.gap)?t.gap[1]:t.gap),G("cols",a),Ge(()=>t.collapsed&&d(t,a)),ie(()=>o.value,()=>{t.collapsed&&d(t,a)}),ie(()=>t.collapsed,e=>{if(e)return d(t,a);g.value=-1}),u({breakPoint:o}),(e,s)=>(P(),L("div",{style:xe(n.value)},[$(e.$slots,"default")],4))}}),Ce=U({name:"GridItem",__name:"GridItem",props:{span:{default:1},offset:{default:0},suffix:{type:Boolean,default:!1},xs:{default:void 0},sm:{default:void 0},md:{default:void 0},lg:{default:void 0},xl:{default:void 0}},setup(i){const u=i,t=k(!0),o=H("hiddenIndex",k(-1)),g=H("breakPoint",k("xl")),d=Qe();ie(()=>[o.value,g.value],e=>{if(!ae(d.index)){if(e[0]===-1){t.value=!0;return}t.value=parseInt(d.index)<Number(e[0])}},{immediate:!0});const r=H("cols",k(4)),a=H("gap",0),n=I(()=>{var _,m;const e=((_=u[g.value])==null?void 0:_.span)??u.span,s=((m=u[g.value])==null?void 0:m.offset)??u.offset,c=e+s>r.value?r.value:e+s,h=s!==0?`calc(((100% + ${a}px) * ${s} / ${e+s}) )`:"unset";return u.suffix?{gridColumnStart:r.value+1-e-s,gridColumnEnd:`span ${e+s}`,marginLeft:h}:{gridColumn:`span ${c}`,marginLeft:h}});return(e,s)=>ce((P(),L("div",{style:xe(n.value)},[$(e.$slots,"default")],4)),[[Ae,t.value]])}}),Ca=U({name:"SearchFormItem",__name:"SearchFormItem",props:{column:{},searchParams:{}},setup(i){const u=i,t=Te(u,"column"),o=I(()=>{var e,s,c;return{label:((e=l(t).fieldNames)==null?void 0:e.label)??"label",value:((s=l(t).fieldNames)==null?void 0:s.value)??"value",children:((c=l(t).fieldNames)==null?void 0:c.children)??"children"}}),g=I(()=>{var m,C;const{label:e,value:s,children:c}=o.value,h=(m=l(t).search)==null?void 0:m.el;let _=((C=l(t).search)==null?void 0:C.props)??{};return h==="tree-select"&&(_={..._,props:{..._,label:e,children:c},nodeKey:s}),h==="cascader"&&(_={..._,props:{..._,label:e,value:s,children:c}}),_}),d=I(()=>{var c,h,_,m,C,T,N;const{search:e}=l(t);return["datetimerange","daterange","monthrange"].includes((c=e==null?void 0:e.props)==null?void 0:c.type)||(h=e==null?void 0:e.props)!=null&&h.isRange?{startPlaceholder:((_=e==null?void 0:e.props)==null?void 0:_.startPlaceholder)??"开始时间",rangeSeparator:((m=e==null?void 0:e.props)==null?void 0:m.rangeSeparator)??"至",endPlaceholder:((C=e==null?void 0:e.props)==null?void 0:C.endPlaceholder)??"结束时间"}:{placeholder:((T=e==null?void 0:e.props)==null?void 0:T.placeholder)??((N=e==null?void 0:e.el)!=null&&N.includes("input")?"请输入":"请选择")+l(t).label}}),r=I(()=>{var s;const{search:e}=l(t);return((s=e==null?void 0:e.props)==null?void 0:s.clearable)??ae(e==null?void 0:e.defaultValue)}),a=H("enumMap",k(new Map)),n=I(()=>{var c;const{column:e}=u;let s=l(a).get(e.prop);return s?(((c=e.search)==null?void 0:c.el)==="select-v2"&&e.fieldNames&&(s=s.map(h=>({...h,label:h[o.value.label],value:h[o.value.value]}))),s):[]});return(e,s)=>{var h,_,m,C,T,N;const c=A("el-option");return P(),w(fe(((h=t.value.search)==null?void 0:h.render)??`el-${(_=t.value.search)==null?void 0:_.el}`),j({...g.value,...d.value,searchParams:e.searchParams,clearable:r.value},{modelValue:e.searchParams[((m=t.value.search)==null?void 0:m.key)??l(D)(t.value.prop)],"onUpdate:modelValue":s[0]||(s[0]=E=>{var x;return e.searchParams[((x=t.value.search)==null?void 0:x.key)??l(D)(t.value.prop)]=E}),modelModifiers:{trim:!0},data:((C=t.value.search)==null?void 0:C.el)==="tree-select"?n.value:[],options:["cascader","select-v2"].includes((T=t.value.search)==null?void 0:T.el)?n.value:[]}),Ee({default:p(()=>{var E;return[((E=t.value.search)==null?void 0:E.el)==="select"?(P(!0),L(X,{key:0},ee(n.value,(x,M)=>(P(),w(c,{label:x[o.value.label],value:x[o.value.value],key:M},null,8,["label","value"]))),128)):$(e.$slots,"default",{key:1})]}),_:2},[((N=t.value.search)==null?void 0:N.el)==="cascader"?{name:"default",fn:p(({data:E})=>[R("span",null,W(E[o.value.label]),1)]),key:"0"}:void 0]),1040,["modelValue","data","options"])}}}),Sa={class:"search-form-box"},wa={class:"gap-1 flex-c"},ka={class:"flex-end mb-[18px]"},xa=U({name:"SearchParam",__name:"index",props:{searchParams:{default:()=>({})},columns:{default:()=>[]},search:{},reset:{},searchCols:{}},setup(i){const u=i,t=k(!0),o=k(),g=I(()=>{var a;return(a=l(o))==null?void 0:a.breakPoint}),d=a=>{var n,e,s,c,h,_,m;return{span:(n=a.search)==null?void 0:n.span,offset:((e=a.search)==null?void 0:e.offset)??0,xs:(s=a.search)==null?void 0:s.xs,sm:(c=a.search)==null?void 0:c.sm,md:(h=a.search)==null?void 0:h.md,lg:(_=a.search)==null?void 0:_.lg,xl:(m=a.search)==null?void 0:m.xl}},r=I(()=>{let a=!1;return u.columns.reduce((n,e)=>{var s,c,h,_;return n+=(((s=e.search[g.value])==null?void 0:s.span)??((c=e.search)==null?void 0:c.span)??1)+(((h=e.search[g.value])==null?void 0:h.offset)??((_=e.search)==null?void 0:_.offset)??0),typeof u.searchCols!="number"?n>=u.searchCols[g.value]&&(a=!0):n>=u.searchCols&&(a=!0),n},0),a});return(a,n)=>{const e=A("el-icon"),s=A("el-tooltip"),c=A("el-form-item"),h=A("el-button"),_=A("el-form");return P(),L("div",Sa,[y(_,{model:a.searchParams},{default:p(()=>[y(Pa,{ref_key:"gridRef",ref:o,collapsed:t.value,gap:[0,30],cols:a.searchCols},{default:p(()=>[(P(!0),L(X,null,ee(a.columns,(m,C)=>(P(),w(Ce,j({key:m.prop,ref_for:!0},d(m),{index:C}),{default:p(()=>[y(c,null,{label:p(()=>{var T,N,E;return[R("div",wa,[R("span",null,W(`${((T=m.search)==null?void 0:T.label)??m.label}`),1),(N=m.search)!=null&&N.tooltip?(P(),w(s,{key:0,effect:"dark",content:(E=m.search)==null?void 0:E.tooltip,placement:"top"},{default:p(()=>[y(e,{class:"cursor-pointer",size:14},{default:p(()=>[y(l(Ye))]),_:1})]),_:2},1032,["content"])):V("",!0)]),n[1]||(n[1]=R("span",null," :",-1))]}),default:p(()=>[y(Ca,{column:m,searchParams:a.searchParams},null,8,["column","searchParams"])]),_:2},1024)]),_:2},1040,["index"]))),128)),y(Ce,{suffix:""},{default:p(()=>[R("div",ka,[y(h,{type:"primary",icon:l(ze),onClick:a.search},{default:p(()=>n[2]||(n[2]=[B("搜索")])),_:1},8,["icon","onClick"]),y(h,{icon:l(de),onClick:a.reset},{default:p(()=>n[3]||(n[3]=[B("重置")])),_:1},8,["icon","onClick"]),r.value?(P(),w(h,{key:0,type:"primary",link:"",onClick:n[0]||(n[0]=m=>t.value=!t.value)},{default:p(()=>[B(W(t.value?"展开":"收起")+" ",1),y(e,{class:"ml-[5px]"},{default:p(()=>[(P(),w(fe(t.value?l(Je):l(qe))))]),_:1})]),_:1})):V("",!0)])]),_:1})]),_:1},8,["collapsed","cols"])]),_:1},8,["model"])])}}}),Aa=Ne(xa,[["__scopeId","data-v-a5b7f277"]]),Ta=(i="id")=>{const u=k(!1),t=k([]),o=I(()=>{const d=[];return t.value.forEach(r=>d.push(r[i])),d});return{isSelected:u,selectList:t,selectIdList:o,onSelectChange:d=>{d.length?u.value=!0:u.value=!1,t.value=d}}};function Ea(i,u={},t=!0,o,g,d){const r={pageNumKey:"pageNum",pageSizeKey:"pageSize",listKey:"list",totalKey:"total"};o&&Object.assign(r,o);const a=Be({tableData:[],loading:!1,pageParams:{pageNum:1,pageSize:10,total:0},searchParams:{},totalParams:{},searchInitParams:{}}),n=()=>{aa(a.searchParams)||s(),e()},e=async()=>{if(!i)return;const{pageNumKey:C,pageSizeKey:T,listKey:N,totalKey:E}=r;try{Object.assign(a.totalParams,u,t?{[C]:a.pageParams.pageNum,[T]:a.pageParams.pageSize}:{}),a.loading=!0;let{data:x}=await i(a.totalParams);g&&(x=g(x)),a.tableData=t?_e(x,N):x,t&&(a.pageParams.total=_e(x,E))}catch(x){d&&d(x)}finally{a.loading=!1}},s=()=>{a.totalParams={};for(let C in a.searchParams)ae(a.searchParams[C])||(a.totalParams[C]=a.searchParams[C])},c=()=>{a.pageParams.pageNum=1,s(),e()},h=()=>{a.pageParams.pageNum=1,a.searchParams={...a.searchInitParams},s(),e()},_=C=>{a.pageParams.pageNum=C,e()},m=C=>{a.pageParams.pageNum=1,a.pageParams.pageSize=C,e()};return{...ea(a),initTable:n,getTableList:e,searchParams2TotalParams:s,search:c,reset:h,handleCurrentChange:_,handleSizeChange:m}}function ue(i,u){return u.includes(".")?(u.split(".").forEach(t=>i=i[t]??"--"),i):i[u]??"--"}function Ve(i,u,t,o){return i.reduce((g,d)=>{if(g)return g;if(d[t]===u)return d;if(d[o])return Ve(d[o],u,t,o)},null)}function Se(i,u,t,o){const g=(t==null?void 0:t.value)??"value",d=(t==null?void 0:t.label)??"label",r=(t==null?void 0:t.children)??"children";let a={};return Array.isArray(u)&&(a=Ve(u,i,g,r)),o=="tag"?a!=null&&a.tagType?a.tagType:"":a?a[d]:"--"}function za(i){return q(i)?i.length?i.join(" / "):"--":i??"--"}function Na(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!ra(i)}const Ba=U({name:"TableColWrapper",__name:"TableColWrapper",props:{column:{}},setup(i){const u=we(),t=H("enumMap",k(new Map)),o=(r,a)=>Se(ue(a.row,r.prop),l(t).get(r.prop),r.fieldNames,"tag")||"primary",g=(r,a)=>l(t).get(r.prop)&&r.isFilterEnum?Se(ue(a.row,r.prop),l(t).get(r.prop),r.fieldNames):za(ue(a.row,r.prop)),d=r=>y(X,null,[r.isShow&&y(A("el-table-column"),j(r,{align:r.align??"center",showOverflowTooltip:r.showOverflowTooltip??r.prop!=="operation"}),{default:a=>{if(r.children)return r.children.map(n=>d(n));if(r.render)return r.render(a);if(r.prop&&u[D(r.prop)])return u[D(r.prop)](a);if(r.tag){let n;return y(A("el-tag"),{type:o(r,a)},Na(n=g(r,a))?n:{default:()=>[n]})}return g(r,a)},header:a=>r.headerRender?r.headerRender(a):r.prop&&u[`${D(r.prop)}Header`]?u[`${D(r.prop)}Header`](a):r.label})]);return(r,a)=>(P(),w(d,ta(na(r.column)),null,16))}}),Ia=U({name:"Pagination",__name:"Pagination",props:{pageParams:{},handleSizeChange:{type:Function},handleCurrentChange:{type:Function}},setup(i){return(u,t)=>{const o=A("el-pagination");return P(),w(o,{background:!0,"current-page":u.pageParams.pageNum,"page-size":u.pageParams.pageSize,total:u.pageParams.total,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,25,50,100],onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])}}}),Ra=U({name:"ColSetting",__name:"ColSetting",props:{settingColumns:{}},setup(i,{expose:u}){const t=k(!1);return u({openColSetting:()=>{t.value=!0}}),(g,d)=>{const r=A("el-table-column"),a=A("el-switch"),n=A("el-table"),e=A("el-drawer");return P(),w(e,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=s=>t.value=s),title:"列设置",size:"450px"},{default:p(()=>[y(n,{data:g.settingColumns,border:!0,"row-key":"prop",class:"col-table"},{empty:p(()=>d[1]||(d[1]=[R("img",{src:Re,alt:"notData"},null,-1),R("div",null,"暂无可配置列",-1)])),default:p(()=>[y(r,{prop:"label",align:"center",label:"列名"}),y(r,{prop:"isShow",align:"center",label:"显示"},{default:p(s=>[y(a,{modelValue:s.row.isShow,"onUpdate:modelValue":c=>s.row.isShow=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(r,{prop:"sortable",align:"center",label:"排序"},{default:p(s=>[y(a,{modelValue:s.row.sortable,"onUpdate:modelValue":c=>s.row.sortable=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])}}}),Va=Ne(Ra,[["__scopeId","data-v-10635a5d"]]),$a={class:"h-full p-5 flex flex-col box-border table-pro"},La={class:"flex-between mt-2 mb-[15px] header-box"},Ua={class:"flex flex-wrap gap-y-[15px] gap-x-3"},ja={key:0,class:"flex gap-y-[15px] gap-x-3"},Ma={class:"leading-7"},Ka={class:"flex-end mt-5"},Fa=U({__name:"index",props:{columns:{default:()=>[]},data:{},api:{},apiAuto:{type:Boolean,default:!0},requestError:{},dataCallback:{},pagination:{type:Boolean,default:!0},fixedParams:{default:{}},border:{type:Boolean,default:!0},toolButton:{type:[Array,Boolean],default:!0},rowKey:{default:"id"},searchCols:{default:()=>({xs:1,sm:2,md:2,lg:3,xl:4})},paramsKeyMap:{}},emits:["search","reset","dragSort"],setup(i,{expose:u,emit:t}){var be;const o=i,g=t,{onSelectChange:d,selectList:r,selectIdList:a,isSelected:n}=Ta(o.rowKey),{tableData:e,loading:s,pageParams:c,searchParams:h,totalParams:_,searchInitParams:m,initTable:C,getTableList:T,search:N,reset:E,handleSizeChange:x,handleCurrentChange:M}=Ea(o.api,o.fixedParams,o.pagination,o.paramsKeyMap,o.dataCallback,o.requestError),O=k(!0),$e=()=>{N(),g("search",_)},Le=()=>{E(),g("reset")},te=Te(o.columns),K=k(new Map);G("enumMap",K);const ne=I(()=>{var f;return(f=Ue.value)==null?void 0:f.filter(b=>{var v,S;return((v=b.search)==null?void 0:v.el)||((S=b.search)==null?void 0:S.render)}).sort((b,v)=>b.search.order-v.search.order)}),Ue=I(()=>me(te.value)),me=(f,b=[])=>(f.forEach(v=>{var S;(S=v.children)!=null&&S.length&&b.push(...me(v.children)),b.push(v),v.isShow=v.isShow??!0,v.isSetting=v.isSetting??!0,v.isFilterEnum=v.isFilterEnum??!0,v.enum&&je(v)}),b.filter(v=>{var S;return!((S=v.children)!=null&&S.length)})),je=({prop:f,enum:b})=>{l(K).has(f)&&(Pe(b)||l(K).get(f)===b)||(q(b)&&l(K).set(f,b),l(K).set(f,[]),Pe(b)&&b().then(v=>{const{data:S}=v;Array.isArray(S)&&l(K).set(f,S)}).catch(v=>{console.log("err",v)}))};(be=l(ne))==null||be.forEach((f,b)=>{var Q,Y,J;f.search.order=((Q=f.search)==null?void 0:Q.order)??b+2;const v=((Y=f.search)==null?void 0:Y.key)??D(f.prop),S=(J=f.search)==null?void 0:J.defaultValue;ae(S)||(l(h)[v]=S,l(m)[v]=S)}),ke(()=>{De(),o.apiAuto&&C(),o.data&&(l(c).total=o.data.length)});const re=k(),ge=k("id-"+la()),he=["selection","radio","index","expand","sort"],le=f=>Array.isArray(o.toolButton)?o.toolButton.includes(f):o.toolButton,se=k(""),Me=()=>l(re).clearSelection(),Z=I(()=>o.data?o.pagination?o.data.slice((l(c).pageNum-1)*l(c).pageSize,l(c).pageSize*l(c).pageNum):o.data:e.value),ve=k(),Ke=l(te).filter(f=>{const{type:b,prop:v,isSetting:S}=f;return!he.includes(b)&&v!=="operation"&&S}),Fe=()=>l(ve).openColSetting(),De=()=>{const f=document.querySelector(`#${ge.value} tbody`);va.create(f,{handle:".move",animation:300,onEnd({newIndex:b,oldIndex:v}){const[S]=l(Z).splice(v,1);l(Z).splice(b,0,S),g("dragSort",{newIndex:b,oldIndex:v})}})};return u({tableRef:re,radio:se,tableData:Z,loading:s,pageParams:c,searchParams:h,totalParams:_,searchInitParams:m,isSelected:n,selectList:r,selectIdList:a,initTable:C,getTableList:T,search:N,reset:E,handleSizeChange:x,handleCurrentChange:M,clearSelection:Me,enumMap:K}),(f,b)=>{const v=A("el-button"),S=A("el-radio"),Q=A("el-icon"),Y=A("el-tag"),J=A("el-table-column"),Oe=sa("loading");return P(),L("div",$a,[ce(y(Aa,{columns:ne.value,searchParams:l(h),searchCols:f.searchCols,search:$e,reset:Le},null,8,["columns","searchParams","searchCols"]),[[Ae,O.value]]),R("div",La,[R("div",Ua,[$(f.$slots,"tableHeader",{isSelected:l(n),selectList:l(r),selectIdList:l(a)})]),f.toolButton?(P(),L("div",ja,[$(f.$slots,"toolButton",{},()=>{var z;return[le("refresh")?(P(),w(v,{key:0,icon:l(Ie),circle:"",onClick:l(T)},null,8,["icon","onClick"])):V("",!0),le("setting")&&f.columns.length?(P(),w(v,{key:1,icon:l(oa),circle:"",onClick:Fe},null,8,["icon"])):V("",!0),le("search")&&((z=ne.value)!=null&&z.length)?(P(),w(v,{key:2,icon:l(ze),circle:"",onClick:b[0]||(b[0]=F=>O.value=!O.value)},null,8,["icon"])):V("",!0)]})])):V("",!0)]),ce((P(),w(l(ia),j({ref_key:"tableRef",ref:re},f.$attrs,{id:ge.value,data:Z.value,border:f.border,"row-key":f.rowKey,onSelectionChange:l(d),class:"table-box"}),{append:p(()=>[$(f.$slots,"append")]),empty:p(()=>[R("div",Ma,[$(f.$slots,"empty",{},()=>[b[3]||(b[3]=R("img",{src:Re,alt:"notData"},null,-1)),b[4]||(b[4]=R("div",null,"暂无数据",-1))])])]),default:p(()=>[$(f.$slots,"default"),(P(!0),L(X,null,ee(te.value,z=>(P(),L(X,{key:z},[z.type&&he.includes(z.type)?(P(),w(J,j({key:0,ref_for:!0},z,{align:z.align??"center","reserve-selection":z.type=="selection"}),{default:p(F=>[z.type=="expand"?(P(),L(X,{key:0},[z.render?(P(),w(fe(z.render),j({key:0,ref_for:!0},F),null,16)):$(f.$slots,z.type,j({key:1,ref_for:!0},F))],64)):V("",!0),z.type=="radio"?(P(),w(S,{key:1,modelValue:se.value,"onUpdate:modelValue":b[1]||(b[1]=oe=>se.value=oe),label:F.row[f.rowKey]},{default:p(()=>b[2]||(b[2]=[R("i",null,null,-1)])),_:2},1032,["modelValue","label"])):V("",!0),z.type=="sort"?(P(),w(Y,{key:2,class:"cursor-move"},{default:p(()=>[y(Q,null,{default:p(()=>[y(l(ua))]),_:1})]),_:1})):V("",!0)]),_:2},1040,["align","reserve-selection"])):(P(),w(Ba,{key:1,column:z},Ee({_:2},[ee(Object.keys(f.$slots),F=>({name:F,fn:p(oe=>[$(f.$slots,F,j({ref_for:!0},oe))])}))]),1032,["column"]))],64))),128))]),_:3},16,["id","data","border","row-key","onSelectionChange"])),[[Oe,l(s)]]),$(f.$slots,"pagination",{},()=>[R("div",Ka,[f.pagination?(P(),w(Ia,{key:0,pageParams:l(c),"handle-current-change":l(M),"handle-size-change":l(x)},null,8,["pageParams","handle-current-change","handle-size-change"])):V("",!0)])]),f.toolButton?(P(),w(Va,{key:0,ref_key:"colRef",ref:ve,settingColumns:l(Ke)},null,8,["settingColumns"])):V("",!0)])}}});function Da(i="当前操作存在风险, 是否继续？",u="温馨提示",t="warning",o="确定",g="取消",d=!1){return ya.confirm(i,u,{type:t,confirmButtonText:o,cancelButtonText:g,dangerouslyUseHTMLString:d,draggable:!0})}const Oa=(i,u={},t="温馨提示",o="",g="操作成功",d="warning",r="确定",a="取消",n=!1)=>new Promise(async(e,s)=>{try{await Da(o,t,d,r,a,n);const c=await i(u);if(!String(c==null?void 0:c.code).startsWith("2"))return s(c);pe.success(g),e(!0)}catch(c){s(c)}}),Za=U({name:"tablePro",__name:"tablePro",setup(i){const u=k(),t=Be({fixed:"test"}),o=a=>{const n=JSON.parse(JSON.stringify(a));return n.createTime&&(n.startTime=n.createTime[0]),n.createTime&&(n.endTime=n.createTime[1]),delete n.createTime,ga(n)},g=a=>({list:a.list,total:a.total}),d=async a=>{var n,e;await Oa(ha,{id:a},"温馨提示","是否删除所选用户信息","删除成功"),(n=l(u))==null||n.clearSelection(),(e=l(u))==null||e.getTableList()},r=a=>{console.log("onSearch - params",a.value),console.log("tableProRef",l(u))};return(a,n)=>{const e=A("el-button");return P(),w(Fa,{ref_key:"tableProRef",ref:u,columns:l(ba),api:o,fixedParams:t,dataCallback:g,onSearch:r},{tableHeader:p(s=>[y(e,{type:"primary",icon:l(ca)},{default:p(()=>n[2]||(n[2]=[B("新增用户")])),_:1},8,["icon"]),y(e,{type:"primary",icon:l(da),plain:""},{default:p(()=>n[3]||(n[3]=[B("批量添加用户")])),_:1},8,["icon"]),y(e,{type:"primary",icon:l(pa),plain:""},{default:p(()=>n[4]||(n[4]=[B("导出用户数据")])),_:1},8,["icon"]),y(e,{type:"primary",plain:""},{default:p(()=>n[5]||(n[5]=[B("To 子集详情页面")])),_:1}),y(e,{type:"danger",icon:l(de),plain:"",disabled:!s.isSelected,onClick:c=>d(s.selectIdList)},{default:p(()=>n[6]||(n[6]=[B(" 批量删除用户 ")])),_:2},1032,["icon","disabled","onClick"])]),expand:p(s=>[B(W(s.row),1)]),usernameHeader:p(s=>[y(e,{type:"primary",onClick:n[0]||(n[0]=c=>l(pe).success("我是通过作用域插槽渲染的表头"))},{default:p(()=>[B(W(s.column.label),1)]),_:2},1024)]),createTime:p(s=>[y(e,{type:"primary",link:"",onClick:n[1]||(n[1]=c=>l(pe).success("我是通过作用域插槽渲染的内容"))},{default:p(()=>[B(W(s.row.createTime),1)]),_:2},1024)]),operation:p(s=>[y(e,{type:"primary",link:"",icon:l(fa)},{default:p(()=>n[7]||(n[7]=[B("查看")])),_:1},8,["icon"]),y(e,{type:"primary",link:"",icon:l(ma)},{default:p(()=>n[8]||(n[8]=[B("编辑")])),_:1},8,["icon"]),y(e,{type:"primary",link:"",icon:l(Ie)},{default:p(()=>n[9]||(n[9]=[B("重置密码")])),_:1},8,["icon"]),y(e,{type:"primary",link:"",icon:l(de)},{default:p(()=>n[10]||(n[10]=[B("删除")])),_:1},8,["icon"])]),_:1},8,["columns","fixedParams"])}}});export{Za as default};
